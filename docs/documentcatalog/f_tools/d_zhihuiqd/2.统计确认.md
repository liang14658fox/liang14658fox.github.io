## 1. 当前属期 申请统计/撤销统计

 **zt（来自组件传参）** | **提交勾选** | **撤销勾选** | **申请统计** | **撤销统计** | **统计确认** | **撤销确认** 
--------|----------|----------|----------|----------|----------|----------
 **00** |  ✔      |  ✔      |  ✔      | ❌        | ❌        | ❌        
 **01** | ❌        | ❌        | ❌        |  ✔      |  ✔      | ❌        
 **02** | ❌        | ❌        | ❌        | ❌        | ❌        |  ✔  
 
:::tip
当前属期数据统计页面，`申请统计` `撤销统计` 按钮触发的接口。
<!-- <div style="width:100%;display: flex;
  justify-content: center;padding:1px;background:white;border-radius:10px;margin-bottom:8px;padding:10px">
<img src="/抵扣类勾选6.PNG" style="height:300px;width:510"/>
</div> -->
:::

* 调用接口：/fpgx/fpsqtj
* 请求样例：
```json
{
	“gfsbh”: “购买方统一社会信用代码/纳税人识别号”,
	“sqbz”: “申请类型1.申请统计2.撤销统计”
}
```
* 返回样例：

:::warning
 `fpycxx` 不是表格信息，而是异常信息。可以不用它。
:::

```json
{
	“code”: “返回状态”,
	“message”: “返回信息”,
	“data”: {
		“returncode”: “返回码”,
		“returnmsg”: “返回信息”,
		“pclsh”: “批次流水号”,
    	“fpycxx”: [ { 
			“kprq”: “开票日期”,
 			“fpdm”: “发票代码”, 
			“fphm”: “发票号码”, 
			“skssq”: “税款所属期”, 
			“ckznxzmbh”: “出口转内销证明编号”, 
			“gxsj”: “勾选时间”,
 			“fpzt”: “发票状态”, 
			“sfycpz”: “是否异常凭证”, 
			“sdzt”: “锁定状态” 
			} ],
		“hgjksycxx”: [ { 
			“jkshm”: “缴款书号码”, 
			“tfrq”: “填发日期”, 
			“ckznxzmbh”: “出口转内销证明编号”, 
			“skssq”: “税款所属期”,
			“gxsj”: “勾选时间”, 
			“ycztDm”: “异常状态代码”
		} ]
	}
}
```
## 2. 查询 申请统计/撤销统计 处理结果
:::tip
点击 `申请统计` 按钮后，也就是步骤6，会返回批次流水号信息。根据批次流水号查询处理结果。

如果处理结果表示为成功，
:::
* 调用接口：/fpgx/getfpsqtj
* 请求样例：
```json
{
“gfsbh”: “购买方统一社会信用代码/纳税人识别号”,
“pclsh”:”批次流水号”
}
```
* 返回样例：
```json
{
	“code”: “返回状态”,
	“message”: “返回信息”,
	“data”: {
		“returncode”:”返回码”,
   		“returnmsg”:”返回信息”,
   		“pclsh”:”批次流水号”,
   		“gfsbh”:”购买方统一社会信用代码/纳税人识别号”,
   		“skssq”:”税款所属期”,
   		“code”:”处理结果”,
    	“tjsj”:”统计时间”
	}
}
```
## 3. 当前属期统计 获得表格数据
:::tip
根据步骤6的返回结果中的批次流水号进行查询。
:::
* 调用接口：/fpgx/getDqsqtjxx
* 请求样例：
```json
{
	“gfsbh”: “购买方统一社会信用代码/纳税人识别号”,
	“ssq”: “所属期”,
	“pclsh”: “批次流水号
}
```
* 返回样例：
```json
{
	“gfsbh”: “购买方统一社会信用代码/纳税人识别号”,
	“ssq”: “所属期”,
	“pclsh”: “批次流水号
	“zzslist”:[
		{
			“fplx”:”发票类型代码”,
			“hjfs”:”合计份数”,
			“hjyxdkse”:”有效抵扣税额合计”,
			“ckznxzmfs”:”出口转内销证明份数”,
			“ckznxzmyxdkse”:”出口转内销有效抵扣税额合计”,
			“qtfpfs”:”其他发票份数”,
			“qtfpyxdkse”:”其他发票有效抵扣税额合计”,
			“fplxmc”:”发票类型名称”
		}
	]
}
```



## 3.1 抵扣详情-dialog
统计确认-当前属期数据统计返回的表格中，点击份数弹出表格调用的接口。

:::tip
设计完毕
:::

## 3.2 抵扣详情-合计page
统计确认-当前属期数据统计返回的表格中，点击合计份数弹出表格调用的接口。

:::tip
设计完毕
:::

## 4. 当前属期统计明细导出

:::danger
该接口可能弃用，后期后有一个按照发票类型导出的接口，不传类型就可以导出所有类型。
:::

* /fpgx/getDqsqtjxxmxdc
* 请求样例
```json
{
	“gfsbh”: “购买方统一社会信用代码/纳税人识别号”,
	“ssq”: “所属期”,
	“pclsh”: “批次流水号
}
```


## 5. 当前属期 确认统计/撤销统计
:::tip
`统计确认` `撤销统计` 按钮调用的接口。
:::
* 调用接口：/fpgx/fptjqr
* 请求样例：
```json
{
	“gfsbh”: “购买方统一社会信用代码/纳税人识别号”,
	“sqbz”: “申请类型”
}
```
* 返回样例：
```json
{
	“code”: “返回状态”,
	“message”: “返回信息”
}
```
## 6. 查询 确认统计/撤销统计 处理结果
:::warning
没有设计。
:::
* 调用接口：/fpgx/fkfptjqr
* 请求样例：
```json
{
	“gfsbh”: “购买方统一社会信用代码/纳税人识别号”,
	“pclsh”:”批次流水号”,
	“skssq”:”税款所属期”
}
```
* 返回样例：
```json
{
	“code”: “返回状态”,
	“message”: “返回信息”,
	“data”: {
		“returncode”:”返回码”,
   		“returnmsg”:”返回信息”,
   		“pclsh”:”批次流水号”,
   		“gfsbh”:”购买方统一社会信用代码/纳税人识别号”,
   		“jgzt”:”当前统计确认状态”
	}
}
```
